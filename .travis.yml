language: bash

env:
  global:
    - GIT_AUTHOR_EMAIL=bot@kstm.shinshu-u.ac.jp
    - GIT_AUTHOR_NAME=bot
    - HUGO_VERSION=0.82.0
    - secure: "KQX001AIUmwILvpDjCn9Qsg7OAmZH/ARsBYlwq6Bft9BmsheaRuBj07ChTal5WK/586YEp3Dc6Dw/H9rMaAoyF6Ea4HzrcEHOh1THn9+Q5XDgwuw4gnt+jcepcdrbGm4clyC/bAXC4XJ8CjP4grwQB/PxEbzz2R9Hez+YiEK/AaA0kR2dD2npF31m+vmMkmoJBW2VupmD9l2hpN/2+yWlcp9dssxMCsUZj/SmjZg08s0SyuPM2aG48lXhnn5hbN4Jt7WJ+3IMcpDY+kzqJ0v95LZWBj7yx/sEjH3bk/OPhPnZ2edCnpDzOfB6BV9FakdJAxoWV3umqIAq6flZilVMxMCl81KKO/rzawOOLVBaiDHOhZj1fa82/bj3jXGXxbYH8QQ6tsM41l7xJ8iT6QqcpN/cpU+vz3i5WSw2hKIMXhOOrstL53ps2sYU5VNSn33UKXVE1eGqMU8r333WHqHavE0KYVJ23FzofXENY3yEENp0SVsPWL2jdEQyLmpv17Jq024lP6djTYT1iyL6tcXexKtEZWp5GqQzwGFDHx7UiAGexQGqKoQVysv95H+Y78Cthd17ua6hTooribO+4jxI0CPsZGzhQqd+SqxYt9gRoGHju5XWR/e0PRmpgXlb+8DVK4IQ9Nk4IjGdsEwwS5It0KZR44IiocsZ8gSBlnE8G8="
    - GIT_URL=https://${GIT_TOKEN}@github.com/kstm-su/blog.git

install:
  - wget https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.tar.gz
  - tar xzf hugo_${HUGO_VERSION}_Linux-64bit.tar.gz

before_deploy:
  - git remote set-url origin ${GIT_URL}
  - git fetch origin gh-pages:remotes/origin/gh-pages
  - git worktree add -B gh-pages public origin/gh-pages
  - ./hugo

deploy:
  skip_cleanup: true
  provider: script
  script: scripts/deploy.sh
  on:
    branch: master
